5
COPY
START
0
0

10
FIRST
STL
RETADR
0
3
15

LDB
#LENGTH
3
6
20

BASE
LENGTH
6

25
CLOOP
JSUB
RDREC
6
9
30

LDA
LENGTH
9
C
35

COMP
#0
C
F
40

JEQ
ENDFIL
F
12
45

JSUB
WRREC
12
15
50

J
CLOOP
15
18
55
ENDFIL
LDA
=C'End'
18
1B
60

STA
BUFFER
1B
1E
65

LDS
#3
1E
21
70

STS
LENGTH
21
24
75

JSUB
WRREC
24
27
80

J
@RETADR
27
2A
85

USE
CDATA
0

90
RETADR
RESW
1
0
3
95
LENGTH
RESW
1
3
6
100

USE
Cbks
0

105
BUFFER
RESB
4098
0
1002
110
BUFEND
EQU
*
1002
1002
115
MAXLEN
EQU
BUFEND-BUFFER
1002
1002
120
$
.



125
$
.   SUBROUTINE RDREC



130
$
.



135

USE

2A

140
RDREC
CLEAR
A
2A
2C
145

CLEAR
S
2C
2E
150

CLEAR
X
2E
30
155

+LDT
#MAXLEN
30
34
160
RLOOP
TD
INPUT
34
37
165

JEQ
RLOOP
37
3A
170

RD
INPUT
3A
3D
175

COMPR
A,S
3D
3F
180

JEQ
EXIT
3F
42
185

STCH
BUFFER,X
42
45
190

TIXR
T
45
47
195

JLT
rloop
47
4A
200
Exit
STX
LENGTH
4A
4D
205

RSUB

4D
50
210

USE
CDATA
6

215
INPUT
BYTE
X'F2'
6
7
220
$
.



225
$
.   SUBROUTINE WRREC



230
$
.



235

USE

50

240
WRREC
CLEAR
X
50
52
245

LDT
LENGTH
52
55
250
WLOOP
TD
=X'03'
55
58
255

JEQ
WLOOP
58
5B
260

LDCH
BUFFER,X
5B
5E
265

WD
=X'03'
5E
61
270

TIXR
T
61
63
275

JLT
WLOOP
63
66
280
XTR
LDT
WLOOP+21
66
69
285

RSUB

69
6C
290

USE
CDATA
7

295
300

END
FIRST
7

